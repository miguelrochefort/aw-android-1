{"version":3,"sources":["webpack:///./src/util/time.js","webpack:///./src/visualizations/PeriodUsage.vue?b70b","webpack:///./src/visualizations/PeriodUsage.vue?af07","webpack:///./src/visualizations/PeriodUsage.vue?7950","webpack:///./src/visualizations/PeriodUsage.vue?572e","webpack:///./src/visualizations/periodusage.js","webpack:///./src/visualizations/PeriodUsage.vue?338f","webpack:///src/visualizations/PeriodUsage.vue","webpack:///./src/visualizations/PeriodUsage.vue"],"names":["__webpack_require__","r","__webpack_exports__","moment__WEBPACK_IMPORTED_MODULE_0__","moment__WEBPACK_IMPORTED_MODULE_0___default","n","seconds_to_duration","seconds","result","hrs","Math","floor","min","sec","get_day_start","datestr","datestart","moment","set","get_prev_day","add","get_next_day","content","module","i","options","hmr","transform","insertInto","undefined","locals","exports","_node_modules_style_loader_index_js_node_modules_css_loader_dist_cjs_js_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_sass_loader_lib_loader_js_node_modules_vue_loader_lib_index_js_vue_loader_options_PeriodUsage_vue_vue_type_style_index_0_id_25b6e8a4_scoped_true_lang_scss___WEBPACK_IMPORTED_MODULE_0__","push","d3","require","_","set_status","svg_elem","msg","innerHTML","select","append","attr","text","diagramcolor","diagramcolor_selected","diagramcolor_focused","periodusage","create","update","usage_arr","link_prefix","dateformat","length","svg","get_usage_time","day_events","day_event","head","filter","e","data","status","duration","usage_times","map","longest_usage","max","apply","padding","width","center_elem","each","events","usage_time","height","date","timestamp","format","color","x","isSame","rect","style","on","d","j","a","getAttribute","me","url","concat","window","location","assign","time","visualizations_PeriodUsagevue_type_script_lang_js_","name","props","mounted","this","$el","watch","periodusage_arr","component","Object","componentNormalizer","_h","$createElement","_self","_c"],"mappings":"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","file":"static/js/12.af3256de7a534cdddc32.js","sourcesContent":["import moment from 'moment';\n\nexport default {\n    seconds_to_duration(seconds) {\n        var result = \"\";\n        var hrs = Math.floor(seconds/60/60);\n        var min = Math.floor(seconds/60%60);\n        var sec = Math.floor(seconds%60);\n        if (hrs != 0)\n            result += hrs + \"h\";\n        if (hrs != 0 || min != 0)\n            result += min + \"m\";\n        if (hrs == 0)\n            result += sec + \"s\";\n        return result;\n    },\n\n    get_day_start(datestr) {\n      // Get start time of date\n      var datestart = moment(datestr);\n      datestart.set('hour', 0);\n      datestart.set('minute', 0);\n      datestart.set('second', 0);\n      datestart.set('millisecond', 0);\n      return datestart;\n    },\n\n    get_prev_day(datestr){\n      var newdate = moment(datestr).add(-1, 'days');\n      return newdate;\n    },\n\n    get_next_day(datestr){\n      var newdate = moment(datestr).add(1, 'days');\n      return newdate;\n    },\n}\n","\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/lib/loader.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PeriodUsage.vue?vue&type=style&index=0&id=25b6e8a4&scoped=true&lang=scss&\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/lib/loader.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PeriodUsage.vue?vue&type=style&index=0&id=25b6e8a4&scoped=true&lang=scss&\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/lib/loader.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PeriodUsage.vue?vue&type=style&index=0&id=25b6e8a4&scoped=true&lang=scss&\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","import mod from \"-!../../node_modules/style-loader/index.js!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/lib/loader.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PeriodUsage.vue?vue&type=style&index=0&id=25b6e8a4&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../node_modules/style-loader/index.js!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/lib/loader.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PeriodUsage.vue?vue&type=style&index=0&id=25b6e8a4&scoped=true&lang=scss&\"","exports = module.exports = require(\"../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"svg[data-v-25b6e8a4] {\\n  width: 100%;\\n  height: 40pt;\\n  border: 1px solid #999;\\n  margin-top: 0.2em;\\n  margin-bottom: 0.2em;\\n  border-radius: 0.5em;\\n}\\n\", \"\"]);\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('svg')}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\"use strict\";\n\nconst d3 = require(\"d3\");\nconst _ = require(\"lodash\");\nconst moment = require(\"moment\");\n\nimport time from \"../util/time.js\";\n\nfunction create(svg_elem){\n  // Clear element\n  svg_elem.innerHTML = \"\";\n}\n\nfunction set_status(svg_elem, msg){\n  // Select svg canvas\n  svg_elem.innerHTML = \"\";\n  let svg = d3.select(svg_elem);\n\n  svg.append(\"text\")\n   .attr(\"x\", \"5pt\")\n   .attr(\"y\", \"25pt\")\n   .text(msg)\n   .attr(\"font-family\", \"sans-serif\")\n   .attr(\"font-size\", \"20pt\")\n   .attr(\"fill\", \"black\");\n}\n\nvar diagramcolor = \"#aaa\";\nvar diagramcolor_selected = \"#fc5\";\nvar diagramcolor_focused = \"#adf\";\n\nfunction update(svg_elem, usage_arr, link_prefix, dateformat) {\n  // No apps, sets status to \"No data\"\n  if (usage_arr.length <= 0){\n    set_status(svg_elem, \"No data\");\n    return svg;\n  }\n  svg_elem.innerHTML = \"\";\n  var svg = d3.select(svg_elem);\n\n  function get_usage_time(day_events){\n    var day_event = _.head(_.filter(day_events, (e) => e.data.status == \"not-afk\"));\n    return day_event != undefined ? day_event.duration : 0;\n  }\n\n  var usage_times = usage_arr.map(day_events => get_usage_time(day_events));\n  var longest_usage = Math.max.apply(null, usage_times);\n  // Avoid division by zero\n  if (longest_usage <= 0){\n    longest_usage = 0.00000000001;\n  }\n\n  var padding = 0.3 * (100 / (usage_arr.length-1));\n  var width = (100/usage_arr.length) - padding;\n  var center_elem = Math.floor(usage_arr.length/2);\n\n  _.each(usage_arr, (events, i) => {\n    var usage_time = get_usage_time(events);\n    var height = 85 * (usage_time / longest_usage);\n    var date = \"\";\n    if (events.length > 0) {\n      // slice off so it's only the day\n      date = moment(usage_arr[i][0].timestamp).format('YYYY-MM-DD');\n    }\n    var color = (i == center_elem) ? diagramcolor_selected : diagramcolor;\n    var offset = 50;\n\n    let x = i * padding + i * width + 0.25 * width;\n\n    if(moment(date).isSame(moment(), \"day\")) {\n      svg.append(\"line\")\n        .attr(\"x1\", x + width / 2 + \"%\")\n        .attr(\"y1\", 0)\n        .attr(\"x2\", x + width / 2 + \"%\")\n        .attr(\"y2\", 200)\n        .attr(\"style\", \"stroke: #888; stroke-width: 2px;\")\n        .attr(\"stroke-dasharray\", \"4, 2\")\n\n      svg.append(\"text\")\n        .attr(\"x\", x + 1.5*width + \"%\")\n        .attr(\"y\", \"30\")\n        .text(\"Today\")\n    }\n\n    let rect = svg.append(\"rect\")\n      .attr(\"x\", x + \"%\")\n      .attr(\"y\", 101 - height + \"%\") // Draw rect bottom-up\n      .attr(\"rx\", 3)\n      .attr(\"ry\", 3)\n      .attr(\"style\", (i == center_elem) ? \"stroke: black; stroke-width: 1;\" : \"stroke: #222; stroke-width: 1;\")\n      .attr(\"width\", width + \"%\")\n      .attr(\"height\", height + offset + \"%\")\n      .attr(\"color\", color)\n      .attr(\"date\", date)\n      .attr(\"data\", link_prefix)\n      .style(\"fill\", color)\n      .on(\"mouseover\", () => {\n          rect.style(\"fill\", diagramcolor_focused);\n      })\n      .on(\"mouseout\", (d, j, n) => {\n          var a = n[j];\n          rect.style(\"fill\", a.getAttribute(\"color\"));\n      })\n      .on(\"click\", function(d, j, n) {\n        var me = n[j];\n        var date = d3.select(me).attr('date');\n        var link_prefix = d3.select(me).attr('data');\n        var url = `/#${link_prefix}/${date}`;\n        /* Not the vue-way, but works */\n        window.location.assign(url);\n        /* Hardcoding click behavior also isn't optimal I guess */\n      });\n    rect.append(\"title\").text(moment(date).format(dateformat)+\"\\n\"+time.seconds_to_duration(usage_time));\n  });\n}\n\nexport default {\n  \"create\": create,\n  \"update\": update,\n  \"set_status\": set_status,\n};\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PeriodUsage.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PeriodUsage.vue?vue&type=script&lang=js&\"","<template lang=\"pug\">\nsvg\n</template>\n\n<style scoped lang=\"scss\">\nsvg {\n    width: 100%;\n    height: 40pt;\n    border: 1px solid #999;\n    margin-top: 0.2em;\n    margin-bottom: 0.2em;\n    border-radius: 0.5em;\n}\n</style>\n\n<script>\n// NOTE: This is just a Vue.js component wrapper for summary.js\n//       Code should generally go in the framework-independent file.\n\nimport periodusage from './periodusage.js';\n\nexport default {\n  name: \"aw-periodusage\",\n  props: ['periodusage_arr', 'link_prefix', 'dateformat'],\n  mounted: function() {\n    periodusage.create(this.$el);\n    periodusage.set_status(this.$el, \"Loading...\");\n  },\n  watch: {\n    \"periodusage_arr\": function() {\n      periodusage.update(this.$el, this.periodusage_arr, this.link_prefix, this.dateformat);\n    }\n  }\n}\n</script>\n","import { render, staticRenderFns } from \"./PeriodUsage.vue?vue&type=template&id=25b6e8a4&scoped=true&lang=pug&\"\nimport script from \"./PeriodUsage.vue?vue&type=script&lang=js&\"\nexport * from \"./PeriodUsage.vue?vue&type=script&lang=js&\"\nimport style0 from \"./PeriodUsage.vue?vue&type=style&index=0&id=25b6e8a4&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"25b6e8a4\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}