{"version":3,"sources":["webpack:///./src/util/time.js","webpack:///./src/util/color.js","webpack:///./src/visualizations/VisTimeline.vue?581e","webpack:///./src/visualizations/VisTimeline.vue?8d0f","webpack:///./src/visualizations/VisTimeline.vue?2bd4","webpack:///./src/visualizations/VisTimeline.vue?d9ac","webpack:///./src/util/tooltip.js","webpack:///./src/visualizations/VisTimeline.vue?0108","webpack:///src/visualizations/VisTimeline.vue","webpack:///./src/visualizations/VisTimeline.vue"],"names":["__webpack_require__","r","__webpack_exports__","moment__WEBPACK_IMPORTED_MODULE_0__","moment__WEBPACK_IMPORTED_MODULE_0___default","n","seconds_to_duration","seconds","result","hrs","Math","floor","min","sec","get_day_start","datestr","datestart","moment","set","get_prev_day","add","get_next_day","d","getColorFromString","getTitleAttr","lodash_last__WEBPACK_IMPORTED_MODULE_0__","lodash_last__WEBPACK_IMPORTED_MODULE_0___default","Color","require","scale","scaleOrdinal","domain","customColors","afk","not-afk","hibernating","google-chrome","chromium","firefox","spotify","alacritty","vue","python","javascript","localhost","github.com","stackoverflow.com","lighten","google.com","google.se","messenger.com","facebook.com","appname","toLowerCase","abs","str","hash","length","i","charCodeAt","hashcode","bucket","e","type","data","app","status","startsWith","file","split","title","URL","url","hostname","replace","err","content","module","options","hmr","transform","insertInto","undefined","locals","exports","_node_modules_style_loader_index_js_node_modules_css_loader_dist_cjs_js_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_sass_loader_lib_loader_js_node_modules_vue_loader_lib_index_js_vue_loader_options_VisTimeline_vue_vue_type_style_index_0_lang_scss___WEBPACK_IMPORTED_MODULE_0__","push","sanitize","DOMPurify","buildTooltip","inner","concat","last_default","language","JSON","stringify","timestamp","format","time","duration","visualizations_VisTimelinevue_type_script_lang_js_","props","timeline","filterShortEvents","zoomMin","zoomMax","stack","tooltip","followMouse","overflowMethod","mounted","_this","this","$nextTick","el","$el","querySelector","watch","buckets","_this2","groups","map_default","bidx","id","showRowLabels","items","chartData","row","group","start","moment_default","end","style","queriedInterval","showQueriedInterval","diff","min_default","item","max_default","max","setOptions","setWindow","setData","computed","_this3","each_default","events","filter_default","sortBy_default","Object","color","Date","component","componentNormalizer","$createElement","_self","_c","_m","_h","attrs"],"mappings":"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","file":"static/js/11.1e59930fed8a5fa081a6.js","sourcesContent":["import moment from 'moment';\n\nexport default {\n    seconds_to_duration(seconds) {\n        var result = \"\";\n        var hrs = Math.floor(seconds/60/60);\n        var min = Math.floor(seconds/60%60);\n        var sec = Math.floor(seconds%60);\n        if (hrs != 0)\n            result += hrs + \"h\";\n        if (hrs != 0 || min != 0)\n            result += min + \"m\";\n        if (hrs == 0)\n            result += sec + \"s\";\n        return result;\n    },\n\n    get_day_start(datestr) {\n      // Get start time of date\n      var datestart = moment(datestr);\n      datestart.set('hour', 0);\n      datestart.set('minute', 0);\n      datestart.set('second', 0);\n      datestart.set('millisecond', 0);\n      return datestart;\n    },\n\n    get_prev_day(datestr){\n      var newdate = moment(datestr).add(-1, 'days');\n      return newdate;\n    },\n\n    get_next_day(datestr){\n      var newdate = moment(datestr).add(1, 'days');\n      return newdate;\n    },\n}\n","'use strict';\n\nimport _ from 'lodash';\nconst Color = require('color');\nconst d3 = require(\"d3\");\n\n\n// See here for examples:\n//   https://bl.ocks.org/pstuffa/3393ff2711a53975040077b7453781a9\n\nlet scale = d3.scaleOrdinal(['#90CAF9', '#FFE082', '#EF9A9A', '#A5D6A7']);\n\n// Needed to prewarm the color table\nscale.domain([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]);\n\nlet customColors = {\n    \"afk\": \"#EEE\",\n    \"not-afk\": \"#7F6\",\n    \"hibernating\": \"#DD6\",\n\n    \"google-chrome\": \"#6AA7FE\",   // Google Blue: \"#4885ed\"\n    \"chromium\": \"#8CF\", // Google Blue: \"#4885ed\"\n    \"firefox\": \"#F94\", // Firefox Orange: \"#E55B0A\"\n    \"spotify\": \"#5FA\",  // Spotify Green: \"#1ED760\"\n    \"alacritty\": \"#FD8\",\n\n    \"vue\": \"#5d9\", // Vue teal #4fc08d\n    \"python\": \"#369\", // Python blue #2b5b84\n    \"javascript\": \"#f6b\", // JavaScript pink #eb47a5\n\n    // Developer domains\n    \"localhost\": \"#CCC\",\n    \"github.com\": \"#EBF\",\n    \"stackoverflow.com\": Color(\"#F48024\").lighten(0.3),\n\n    \"google.com\": \"#0AF\",\n    \"google.se\": \"#0AF\",\n\n    // Social media sites\n    \"messenger.com\": Color(\"#3b5998\").lighten(0.5),\n    \"facebook.com\": Color(\"#3b5998\").lighten(0.5),\n};\n\nfunction hashcode(str){\n    let hash = 0;\n    if (str.length === 0) {\n      return hash;\n    }\n    for (var i = 0; i < str.length; i++) {\n        var character = str.charCodeAt(i);\n        hash = ((hash<<5)-hash)+character;\n        hash = hash & hash; // Convert to 32bit integer\n    }\n    return hash;\n}\n\nexport function getColorFromString(appname) {\n    appname = appname || \"\";\n    appname = appname.toLowerCase();\n    return customColors[appname] || scale(Math.abs(hashcode(appname) % 20));\n}\n\nexport function getTitleAttr(bucket, e) {\n  if(bucket.type == \"currentwindow\") {\n    return e.data.app;\n  } else if(bucket.type == \"web.tab.current\") {\n    try {\n      return (new URL(e.data.url)).hostname.replace(\"www.\", \"\");\n    } catch(err) {\n      return e.data.url;\n    }\n  } else if(bucket.type == \"afkstatus\") {\n    return e.data.status;\n  } else if(bucket.type.startsWith(\"app.editor\")) {\n    return _.last(e.data.file.split(\"/\"));\n  } else {\n    return e.data.title;\n  }\n}\n","\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/lib/loader.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./VisTimeline.vue?vue&type=style&index=0&lang=scss&\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/lib/loader.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./VisTimeline.vue?vue&type=style&index=0&lang=scss&\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/lib/loader.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./VisTimeline.vue?vue&type=style&index=0&lang=scss&\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","import mod from \"-!../../node_modules/style-loader/index.js!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/lib/loader.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./VisTimeline.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../node_modules/style-loader/index.js!../../node_modules/css-loader/dist/cjs.js!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/sass-loader/lib/loader.js!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./VisTimeline.vue?vue&type=style&index=0&lang=scss&\"","exports = module.exports = require(\"../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"div#visualization {\\n  margin-top: 0.5em;\\n  margin-bottom: 0.5em;\\n}\\ndiv#visualization .timeline-timeline {\\n    font-family: sans-serif !important;\\n}\\ndiv#visualization .timeline-timeline .timeline-panel {\\n      box-sizing: border-box;\\n}\\ndiv#visualization .timeline-timeline .timeline-item {\\n      border-color: rgba(0, 0, 0, 0.075);\\n      border-radius: 2px;\\n}\\n\", \"\"]);\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{attrs:{\"id\":\"visualization\"}})])}]\n\nexport { render, staticRenderFns }","import moment from 'moment';\nimport time from './time.js';\nimport DOMPurify from 'dompurify';\nimport _ from 'lodash';\n\nlet sanitize = DOMPurify.sanitize;\n\nexport function buildTooltip(bucket, e) {\n  // WARNING: XSS risk, make sure to sanitize properly\n  // FIXME: Not actually tested against XSS attacks, implementation needs to be verified in tests.\n  let inner = \"Unknown bucket type\";\n  if(bucket.type == \"currentwindow\") {\n    inner = `\n      <tr><th>App:</th><td>${sanitize(e.data.app)}</td></tr>\n      <tr><th>Title:</th><td>${sanitize(e.data.title)}</td></tr>\n      `;\n  } else if(bucket.type == \"web.tab.current\") {\n    inner = `\n      <tr><th>Title:</th><td>${sanitize(e.data.title)}</td></tr>\n      <tr><th>URL:</th><td><a href=${sanitize(e.data.url)}>${sanitize(e.data.url)}</a></td></tr>\n      `;\n  } else if(bucket.type.startsWith(\"app.editor\")) {\n    inner = `\n      <tr><th>Filename:</th><td>${sanitize(_.last(e.data.file.split(\"/\")))}</td></tr>\n      <tr><th>Path:</th><td>${sanitize(e.data.file)}</td></tr>\n      <tr><th>Language:</th><td>${sanitize(e.data.language)}</td></tr>\n      `;\n  } else {\n    inner = `\n      <tr><td>Data:</td><td>${sanitize(JSON.stringify(e.data))}</td></tr>\n      `;\n  }\n  return `<table>${inner}\n    <tr></tr>\n    <tr><th>Time:</th><td>${moment(e.timestamp).format()}</td></tr>\n    <tr><th>Duration:</th><td>${time.seconds_to_duration(e.duration)}</td></tr>\n    </table>`;\n}\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./VisTimeline.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./VisTimeline.vue?vue&type=script&lang=js&\"","<template lang=\"pug\">\ndiv\n  div#visualization\n</template>\n\n\n<style lang=\"scss\">\ndiv#visualization {\n  margin-top: 0.5em;\n  margin-bottom: 0.5em;\n\n  .timeline-timeline {\n    font-family: sans-serif !important;\n\n    .timeline-panel {\n      box-sizing: border-box;\n    }\n\n    .timeline-item {\n      border-color: rgba(0, 0, 0, 0.075);\n      border-radius: 2px;\n    }\n  }\n}\n</style>\n\n\n<script>\nimport _ from 'lodash';\nimport moment from 'moment';\nimport {buildTooltip} from '../util/tooltip.js'\nimport {getColorFromString, getTitleAttr} from '../util/color.js'\n\nimport {Timeline} from 'timeline-plus/dist/timeline.js';\nimport 'timeline-plus/dist/timeline.css';\n\nexport default {\n  props: ['buckets', 'showRowLabels', 'queriedInterval', 'showQueriedInterval'],\n  data () {\n    return {\n      timeline: null,\n      filterShortEvents: true,\n      options: {\n        zoomMin: 1000 * 60,             // 10min in milliseconds\n        zoomMax: 1000 * 60 * 60 * 24 * 31 * 3,    // about three months in milliseconds\n        stack: false,\n        tooltip: {\n          followMouse: true,\n          overflowMethod: 'cap',\n        }\n      }\n    };\n  },\n  mounted() {\n    this.$nextTick(() => {\n      let el = this.$el.querySelector('#visualization');\n      this.timeline = new Timeline(el, [], [], this.options);\n    });\n  },\n  watch: {\n    buckets() {\n      // For some reason, an object is passed here, after which the correct array arrives\n      if(this.buckets.length === undefined) {\n        //console.log(\"I told you so!\")\n        return;\n      }\n\n      // Build groups\n      let groups = _.map(this.buckets, (bucket, bidx) => {\n        return {id: bidx, content: this.showRowLabels ? '': bucket.id};\n      });\n\n      // Build items\n      let items = _.map(this.chartData, (row, i) => {\n        return {\n          id: i,\n          group: row[0],\n          content: row[1],\n          title: row[2],\n          start: moment(row[3]),\n          end: moment(row[4]),\n          style: `background-color: ${row[5]}`,\n        }\n      });\n\n      if(groups.length > 0 && items.length > 0) {\n        if(this.queriedInterval && this.showQueriedInterval) {\n          let duration = this.queriedInterval[1].diff(this.queriedInterval[0], \"seconds\");\n          groups.push({id: groups.length, content: \"queried interval\"});\n          items.push({\n            id: items.length + 1,\n            group: groups.length - 1,\n            title: buildTooltip({\"type\": \"test\"}, {\n              timestamp: this.queriedInterval[0],\n              duration: duration,\n              data: {title: 'test'}\n            }),\n            content: 'query',\n            start: this.queriedInterval[0],\n            end: this.queriedInterval[1],\n            style: \"background-color: #aaa; height: 10px\",\n          });\n        }\n\n        let start = (this.queriedInterval && this.queriedInterval[0]) || _.min(_.map(items, (item) => item.start));\n        let end = (this.queriedInterval && this.queriedInterval[1]) || _.max(_.map(items, (item) => item.end));\n        this.options.min = start;\n        this.options.max = end;\n        this.timeline.setOptions(this.options);\n        this.timeline.setWindow(start, end);\n        this.timeline.setData({groups: groups, items: items})\n      }\n    }\n  },\n  computed: {\n    chartData() {\n      let data = [];\n      _.each(this.buckets, (bucket, bidx) => {\n        if(bucket.events === undefined) {\n          return;\n        }\n        let events = bucket.events;\n        // Filter out events shorter than 1 second (notably including 0-duration events)\n        // TODO: Use flooding instead, preferably with some additional method of removing/simplifying short events for even greater performance\n        if(this.filterShortEvents) {\n          events = _.filter(events, (e) => e.duration > 1);\n        }\n        events = _.sortBy(events, (e) => e.timestamp);\n        _.each(events, (e) => {\n          data.push([\n            bidx,\n            getTitleAttr(bucket, e),\n            buildTooltip(bucket, e),\n            new Date(e.timestamp),\n            new Date(moment(e.timestamp).add(e.duration, 'seconds')),\n            getColorFromString(getTitleAttr(bucket, e)),\n          ]);\n        })\n      })\n      return data;\n    },\n  },\n}\n</script>\n","import { render, staticRenderFns } from \"./VisTimeline.vue?vue&type=template&id=af06d29c&lang=pug&\"\nimport script from \"./VisTimeline.vue?vue&type=script&lang=js&\"\nexport * from \"./VisTimeline.vue?vue&type=script&lang=js&\"\nimport style0 from \"./VisTimeline.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}